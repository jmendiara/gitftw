<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Git For The Workflows</title>
    
    <meta name="description" content="Basic git commands wrapped in node for using in your workflows" />
    
        <meta name="keywords" content="git workflow grunt gulp" />
        <meta name="keyword" content="git workflow grunt gulp" />
    
    
    
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    
    <meta property="og:url" content=""/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":true,"cleverLinks":true,"applicationName":"Git For The Workflows","default":{"outputSourceFiles":true},"disqus":"","googleAnalytics":"","openGraph":{"title":"","type":"website","image":"","site_name":"","url":""},"meta":{"title":"Git For The Workflows","description":"Basic git commands wrapped in node for using in your workflows","keyword":"git workflow grunt gulp"},"linenums":true};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html">Git For The Workflows</a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="git">
            <span class="title">
                <a href="git.html">git</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="git.events"><a href="git.html#events">events</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="git.add"><a href="git.html#add">add</a></li>
            
                <li data-name="git.checkout"><a href="git.html#checkout">checkout</a></li>
            
                <li data-name="git.clone"><a href="git.html#clone">clone</a></li>
            
                <li data-name="git.command"><a href="git.html#command">command</a></li>
            
                <li data-name="git.commit"><a href="git.html#commit">commit</a></li>
            
                <li data-name="git.fetch"><a href="git.html#fetch">fetch</a></li>
            
                <li data-name="git.getCurrentBranch"><a href="git.html#getCurrentBranch">getCurrentBranch</a></li>
            
                <li data-name="git.getTags"><a href="git.html#getTags">getTags</a></li>
            
                <li data-name="git.isClean"><a href="git.html#isClean">isClean</a></li>
            
                <li data-name="git.merge"><a href="git.html#merge">merge</a></li>
            
                <li data-name="git.pull"><a href="git.html#pull">pull</a></li>
            
                <li data-name="git.push"><a href="git.html#push">push</a></li>
            
                <li data-name="git.removeLocalBranch"><a href="git.html#removeLocalBranch">removeLocalBranch</a></li>
            
                <li data-name="git.removeLocalTags"><a href="git.html#removeLocalTags">removeLocalTags</a></li>
            
                <li data-name="git.removeRemoteBranch"><a href="git.html#removeRemoteBranch">removeRemoteBranch</a></li>
            
                <li data-name="git.removeRemoteTags"><a href="git.html#removeRemoteTags">removeRemoteTags</a></li>
            
                <li data-name="git.removeTags"><a href="git.html#removeTags">removeTags</a></li>
            
                <li data-name="git.tag"><a href="git.html#tag">tag</a></li>
            
                <li data-name="git.version"><a href="git.html#version">version</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            <span class="subtitle">Events</span>
            
                <li data-name="git#event:command"><a href="git.html#event:command">command</a></li>
            
                <li data-name="git#event:result"><a href="git.html#event:result">result</a></li>
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="resolvable.js.html">Source: resolvable.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';
/**
 * Resolvable is something that have invariant primitives, including all its properties,
 * now or in the future.
 *
 * Which things are _resolvables_?
 *
 * 1. A String, Number, Boolean primitives: `string`, 4, true
 *
 * 2. A array of resolvables: `['string', resolvable]`
 *
 * 3. A literal object with resolvables properties: `{ foo: 'string', bar: resolvable }`
 *
 * 5. An object with a `toString` method
 *
 * 6. An A+ promise (Q, bluebird, native...) that resolves to a resolvable: `Promise.when('string')`
 *
 * 7. A function that returns resolvables `function() { return 'string'; }`
 *
 * __resolvables__ are resolved in serie. Once something is resolved, goes to resolve
 * the next one. Never in parallel. This avoids race conditions
 * in your workflows while maintaining your code clean.
 *
 * @example
 * //Using Q as promise library
 *
 * var resolvableArray = [
 *   'string',
 *   Q.when('string'),
 *   function() {
 *    return 'string';
 *   },
 *   function() {
 *    return Q.when('string');
 *   }
 * ];
 * var resolvableObject = {
 *  arr: resolvableArray,
 *  string: 'string'
 * }
 *
 * //In the future, after resolving it, will become
 * var resolvableArray = ['string', 'string', 'string', 'string'];
 * var resolvableObject = {
 *  arr: ['string', 'string', 'string', 'string'],
 *  string: 'string'
 * }
 *
 *
 * @typedef Resolvable
 */

var Promise = require('bluebird');

/**
 * Returns true when an  object is a Promise-like one
 * @param {*} o The thing to test
 * @returns {boolean} true when is promise-like, false otherwise
 */
function isThenable(o) {
  return o &amp;&amp; typeof o.then === 'function';
}

/**
 * Resolves an array
 *
 * @private
 * @param {Array} arg  The array to resolve
 * @returns {Promise} The resolved array
 */
function resolveArray(arg) {
  var resolvedArray = new Array(arg.length);
  return arg
      .reduce(function(soFar, value, index) {
        return soFar
            .then(resolveItem.bind(null, value))
            .then(function(value) {
              resolvedArray[index] = value;
            });
      }, Promise.resolve())
      .then(function() {
        return resolvedArray;
      });
}

/**
 * Resolves an object
 *
 * @private
 * @param {Object} arg The object to resolve
 * @returns {Promise} The resolved object
 */
function resolveObject(arg) {
  var resolvedObject = {};
  return Object.keys(arg)
      .reduce(function(soFar, key) {
        return soFar
            .then(resolveItem.bind(null, arg[key]))
            .then(function(value) {
              resolvedObject[key] = value;
            });
      }, Promise.resolve())
      .then(function() {
        return resolvedObject;
      });
}

/**
 * Resolves something resolvable
 *
 * @private
 * @param {*} arg The argument to resolve
 * @returns {Promise} The resolved
 */
function resolveItem(arg) {
  if (Array.isArray(arg)) {
    return resolveArray(arg);
  } else if (Object.prototype.toString.call(arg) === '[object Function]') {
    //is a function
    return Promise.method(arg)().then(resolveItem);
  } else if (isThenable(arg)) {
    //is a promise
    return arg.then(resolveItem);
  } else if (arg &amp;&amp; typeof arg === 'object') {
    //is an object
    if (typeof arg.toString === 'function') {
      var value = arg.toString();
      if (value !== '[object Object]') {
        //with a valid toString
        return Promise.resolve(value);
      }
    }
    return resolveObject(arg);
  } else {
    //Yeah! a value
    return Promise.resolve(arg);
  }
}

module.exports = resolveItem;
</code></pre>
        </article>
    </section>






        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha9</a> on Tue Dec 23 2014 13:03:06 GMT+0100 (CET)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>
